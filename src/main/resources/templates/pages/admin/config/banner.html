<link rel="stylesheet" th:href="@{/css/admin/config/banner.css}">
<link rel="stylesheet" th:href="@{/css/basic.css}">
    <header th:replace="layout/admin/header.html"></header>
    <main>
        <aside th:replace="layout/admin/aside.html"></aside>
        <div class="container">
            <div class="header">
                <span class="header-title">배너관리</span>
                <div class="header-right">
                    <span>HOME</span>
                    <span>></span>
                    <span>환경설정</span>
                    <span>></span>
                    <span class="bold">배너관리</span>
                </div>
            </div>

            <div class="header-gubun"></div>

            <div class="main">
                <div class="section">
                    <div onclick="nav(event)" class="tab1 banner-main-top active">메인상단 배너</div>
                    <div onclick="nav(event)" class="tab2 banner-main-slide">메인슬라이드 배너</div>
                    <div onclick="nav(event)" class="tab3 banner-product-view">상품 상세보기 배너</div>
                    <div onclick="nav(event)" class="tab4 banner-login">회원로그인 배너</div>
                    <div onclick="nav(event)" class="tab5 banner-my">마이페이지 배너</div>
                </div>

                <div class="header-title2">메인상단 배너</div>
                <div class="header-gubun2"></div>

                <table class="tb1">
                    <tr>
                        <th class="checkbox">
                            <input type="checkbox" id="allCheck">
                        </th>
                        <th class="no">번호</th>
                        <th class="img">이미지</th>
                        <th class="info">배너정보</th>
                        <th class="place">배너위치</th>
                        <th class="start-date">시작일</th>
                        <th class="end-date">종료일</th>
                        <th class="start-time">시작시간</th>
                        <th class="end-time">종료시간</th>
                        <th class="admin">관리</th>
                    </tr>
                    <tr>
                        <td class="checkbox">
                            <input type="checkbox" name="" id="">
                        </td>
                        <td>1</td>
                        <td>
                            <img src="../images/x-img2.png" alt="">
                        </td>
                        <td class="td-info">
                            <div class="name">특정배너명</div>
                            <div class="size">크기 : 1200 x 80</div>
                            <div class="bgcolor">배경색 : #ffff00</div>
                            <div class="link">배너링크</div>
                        </td>
                        <td>MAIN1</td>
                        <td>2023/01/01</td>
                        <td>2023/01/07</td>
                        <td>13:00</td>
                        <td>15:00</td>
                        <td class="td-admin">
                            <input type="button" value="[ 삭제 ]">
                            <input type="button" value="[ 수정 ]">
                        </td>
                    </tr>
                    <tr>
                        <td class="checkbox">
                            <input type="checkbox" name="" id="">
                        </td>
                        <td>1</td>
                        <td>
                            <img th:src="@{/images/x-img2.png}" alt="">
                        </td>
                        <td class="td-info">
                            <div class="name">특정배너명</div>
                            <div class="size">크기 : 1200 x 80</div>
                            <div class="bgcolor">배경색 : #ffff00</div>
                            <div class="link">배너링크</div>
                        </td>
                        <td>MAIN1</td>
                        <td>2023/01/01</td>
                        <td>2023/01/07</td>
                        <td>13:00</td>
                        <td>15:00</td>
                        <td class="td-admin">
                            <input type="button" value="[ 삭제 ]">
                            <input type="button" value="[ 수정 ]">
                        </td>
                    </tr>
                    <tr>
                        <td class="checkbox">
                            <input type="checkbox" name="" id="">
                        </td>
                        <td>1</td>
                        <td>
                            <img th:src="@{/images/x-img2.png}" alt="">
                        </td>
                        <td class="td-info">
                            <div class="name">특정배너명</div>
                            <div class="size">크기 : 1200 x 80</div>
                            <div class="bgcolor">배경색 : #ffff00</div>
                            <div class="link">배너링크</div>
                        </td>
                        <td>MAIN1</td>
                        <td>2023/01/01</td>
                        <td>2023/01/07</td>
                        <td>13:00</td>
                        <td>15:00</td>
                        <td class="td-admin">
                            <input type="button" value="[ 삭제 ]">
                            <input type="button" value="[ 수정 ]">
                        </td>
                    </tr>
                    <tr>
                        <td class="checkbox">
                            <input type="checkbox" name="" id="">
                        </td>
                        <td>1</td>
                        <td>
                            <img th:src="@{/images/x-img2.png}" alt="">
                        </td>
                        <td class="td-info">
                            <div class="name">특정배너명</div>
                            <div class="size">크기 : 1200 x 80</div>
                            <div class="bgcolor">배경색 : #ffff00</div>
                            <div class="link">배너링크</div>
                        </td>
                        <td>MAIN1</td>
                        <td>2023/01/01</td>
                        <td>2023/01/07</td>
                        <td>13:00</td>
                        <td>15:00</td>
                        <td class="td-admin">
                            <input type="button" value="[ 삭제 ]">
                            <input type="button" value="[ 수정 ]">
                        </td>
                    </tr>
                    <tr>
                        <td class="checkbox">
                            <input type="checkbox" name="" id="">
                        </td>
                        <td>1</td>
                        <td>
                            <img th:src="@{/images/x-img2.png}" alt="">
                        </td>
                        <td class="td-info">
                            <div class="name">특정배너명</div>
                            <div class="size">크기 : 1200 x 80</div>
                            <div class="bgcolor">배경색 : #ffff00</div>
                            <div class="link">배너링크</div>
                        </td>
                        <td>MAIN1</td>
                        <td>2023/01/01</td>
                        <td>2023/01/07</td>
                        <td>13:00</td>
                        <td>15:00</td>
                        <td class="td-admin">
                            <input type="button" value="[ 삭제 ]">
                            <input type="button" value="[ 수정 ]">
                        </td>
                    </tr>
                    <tr>
                        <td class="checkbox">
                            <input type="checkbox" name="" id="">
                        </td>
                        <td>1</td>
                        <td>
                            <img th:src="@{/images/x-img2.png}" alt="">
                        </td>
                        <td class="td-info">
                            <div class="name">특정배너명</div>
                            <div class="size">크기 : 1200 x 80</div>
                            <div class="bgcolor">배경색 : #ffff00</div>
                            <div class="link">배너링크</div>
                        </td>
                        <td>MAIN1</td>
                        <td>2023/01/01</td>
                        <td>2023/01/07</td>
                        <td>13:00</td>
                        <td>15:00</td>
                        <td class="td-admin">
                            <input type="button" value="[ 삭제 ]">
                            <input type="button" value="[ 수정 ]">
                        </td>
                    </tr>
                </table>
                <div class="btns">
                    <button class="delete-btn">선택삭제</button>
                    <button onclick="openBanner()" class="insert-btn">배너등록</button>
                </div>

            </div>
            <div class="popup">
                <div class="header">
                    <div class="title">배너등록</div>
                    <div onclick="closeBanner()" class="btn">X</div>
                </div>
                <form id="bannerForm">
                    <table class="tb2">
                        <tr>
                            <th>배너이름</th>
                            <td>
                                <input class="inp" type="text" name="name" placeholder="배너명 입력">
                            </td>
                        </tr>
                        <tr>
                            <th>배너크기</th>
                            <td>
                                <input class="inp" type="text" name="size" placeholder="배너크기 입력">
                            </td>
                        </tr>
                        <tr>
                            <th>배경색</th>
                            <td>
                                <input class="short" type="color" name="bg" placeholder="배경색 입력">
                            </td>
                        </tr>
                        <tr>
                            <th>배너 이미지 주소</th>
                            <td>
                                <input class="inp" type="text" name="img" placeholder="배너 이미지 링크 입력">
                            </td>
                        </tr>
                        <tr>
                            <th>배너 링크</th>
                            <td>
                                <input class="inp" type="text" name="link" placeholder="배너와 연결될 링크 입력">
                            </td>
                        </tr>
                        <tr>
                            <th>배너위치</th>
                            <td>
                                <select class="place short" name="location">
                                    <option value="1">MAIN1</option>
                                    <option value="2">MAIN2</option>
                                    <option value="3">PRODUCT1</option>
                                    <option value="4">MEMBER1</option>
                                    <option value="5">MY1</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th>노출날짜</th>
                            <td>
                                <input id="start-date" type="date" name="sdate"> ~
                                <input id="end-date" type="date" name="edate">
                            </td>
                        </tr>
                        <tr>
                            <th>노출시간</th>
                            <td>
                                <input id="start-time" type="time" data-placeholder="시 : 분" name="stime"> ~
                                <input id="end-time" type="time" data-placeholder="시 : 분" name="etime">
                            </td>
                        </tr>
                    </table>
                    <div class="btns">
                        <button type="submit" class="submit-btn">등록하기</button>
                    </div>
                </form>
            </div>
            <div class="popupbg"></div>
        </div>
    </main>

    <footer th:replace="layout/admin/footer.html"></footer>
    


    <script>
        const popup = document.querySelector('.popup')
        const bg = document.querySelector('.popupbg')

        function openBanner(){
            popup.style.display = 'block'
            bg.style.display = 'block'
        }

        function closeBanner(){
            popup.style.display = 'none'
            bg.style.display = 'none'
        }

        document.getElementById('start-time').addEventListener('focus', function() {
            this.showPicker();
        });

        document.getElementById('end-time').addEventListener('focus', function() {
            this.showPicker();
        });

        document.getElementById('start-date').addEventListener('focus', function() {
            this.showPicker();
        });

        document.getElementById('end-date').addEventListener('focus', function() {
            this.showPicker();
        });

        function nav(event) {
            // 모든 요소에서 active 클래스를 제거
            const allBanners = document.querySelectorAll('.section > div');
            allBanners.forEach(function(banner) {
                banner.classList.remove('active');
            });
            
            // 클릭한 요소에만 active 클래스 추가
            event.target.classList.add('active');
            document.querySelector('.header-title2').innerText = document.querySelector('.active').innerText    
        }

        const f = document.getElementById('bannerForm');

        f.addEventListener("submit", function (e) {
            e.preventDefault();
            const jsonData = {
                "bannerImg" : f.img.value,
                "bannerName" : f.name.value,
                "bannerSize" : f.size.value,
                "bannerBg" : f.bg.value,
                "bannerLink" : f.link.value,
                "bannerLocation" : f.location.value,
                "bannerSdate" : f.sdate.value,
                "bannerEdate" : f.edate.value,
                "bannerStime" : f.stime.value,
                "bannerEtime" : f.etime.value}

            console.log(jsonData);
            fetch('/admin/config/banner', {
                method: 'POST',
                headers: {"Content-type":"application/json"},
                body: JSON.stringify(jsonData)
            })
                .then(resp => resp.json())
                .then(data => {
                    console.log(data);
                    const tab = data.bannerLocation;
                     if(tab>0){
                         alert('성공적으로 등록되었습니다.');
                         closeBanner();

                         const allBanners = document.querySelectorAll('.section > div');
                         allBanners.forEach(function(banner) {
                             banner.classList.remove('active');
                         });
                         const clas = 'tab'+tab;
                         console.log(clas);
                         const Banner = document.getElementsByClassName(clas)[0];

                         Banner.classList.add('active');
                         document.querySelector('.header-title2').innerText = document.querySelector('.active').innerText

                         window.scrollTo({ // 페이지 상단으로 스크롤 이동
                             top: 0,
                             behavior: 'smooth' // 부드럽게 스크롤 이동
                         });
                     }
                })
                .catch(err =>{
                    console.error(err);
                });
        });

    </script>
</body>
</html>